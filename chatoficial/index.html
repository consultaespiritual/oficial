<!DOCTYPE html>
<html lang="pt-BR">
<head>

  <script>
    window.pixelId = "680b1e5c9df83840f7c11e63";
    var a = document.createElement("script");
    a.setAttribute("async", "");
    a.setAttribute("defer", "");
    a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
    document.head.appendChild(a);
  </script>
  
    <!-- Meta Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '1346739396551784');
      fbq('track', 'PageView');
      </script>
      <noscript><img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=1346739396551784&ev=PageView&noscript=1"
      /></noscript>
      <!-- End Meta Pixel Code -->

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Divino Tarot - Simula√ß√£o WhatsApp</title>
  <style>
    /* Estilos base */
    body {
      margin: 0;
      padding: 0;
      background-color: #efeae2;
      background-image: url('file:///C:/Users/Acer/Downloads/fundowhats.jpg');
      font-family: 'Open Sans', sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden; /* Impede rolagem do body */
    }

    .header {
      background-color: #008069;
      color: #fff;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .avatar {
      width: 36px;
      height: 36px;
      min-width: 36px; /* Evita que o avatar encolha em telas pequenas */
    }

    .avatar img {
      border-radius: 50%;
      width: 100%;
      height: 100%;
      object-fit: cover; /* Garante que a imagem cubra o espa√ßo sem distor√ß√£o */
    }

    .user-info {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .user-info span.name {
      font-size: 17px;
      font-weight: 600;
    }

    .user-info span.status {
      font-size: 13px;
    }

    .header-right i {
      margin-left: 15px;
      cursor: pointer;
      font-size: 16px;
    }

    .chat-box {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      background-color: #efeae2;
      background-image: url('file:///C:/Users/Acer/Downloads/fundowhats.jpg');
      padding-bottom: 70px; /* Altura da input-area + padding */
    }

    .msg {
      max-width: 75%;
      padding: 10px 15px;
      border-radius: 10px;
      margin: 6px 0;
      font-size: 16px;
      word-wrap: break-word; /* Garante que palavras longas n√£o quebrem o layout */
    }

    .msg.bot {
      background-color: #ffffff;
      color: #303235;
      align-self: flex-start;
    }

    .msg.user {
      background-color: #D9FDD2;
      color: #000000;
      align-self: flex-end;
    }

    .input-area {
      padding: 10px;
      background-color: #f0f0f0;
      display: flex;
      align-items: center;
      gap: 10px;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 10;
      border-top: 1px solid #ddd;
      width: 100%;
      box-sizing: border-box;
    }

    .input-area input {
      flex: 1;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 20px;
      font-size: 18px; /* Aumentado para 16px para evitar zoom em dispositivos m√≥veis */
      -webkit-appearance: none; /* Evita estilo padr√£o em iOS */
      appearance: none;
    }

    .input-area button {
      background-color: #008069;
      border: none;
      color: white;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      min-width: 40px; /* Evita que o bot√£o encolha em telas pequenas */
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    /* Estilos para elementos de √°udio e imagem */
    audio {
      max-width: 100%;
      margin: 5px 0;
    }

    .msg img {
      max-width: 100%;
      height: auto;
      border-radius: 5px;
      margin: 5px 0;
    }

    /* Destaque para ofertas limitadas */
    .limited-offer {
      color: #d32f2f;
      font-weight: bold;
    }

    /* Media Queries para Responsividade */

    /* Telas muito pequenas (smartphones pequenos) */
    @media (max-width: 320px) {
      .header {
        padding: 8px 5px;
      }
      
      .header-right i {
        margin-left: 10px;
        font-size: 16px;
      }
      
      .avatar {
        width: 32px;
        height: 32px;
        min-width: 32px;
      }
      
      .user-info span.name {
        font-size: 15px;
      }
      
      .user-info span.status {
        font-size: 11px;
      }
      
      .msg {
        max-width: 85%; /* Aumenta um pouco a largura em telas pequenas */
        padding: 8px 12px;
        font-size: 13px;
      }
      
      .input-area {
        padding: 8px 5px;
      }
      
      .input-area input {
        padding: 8px;
        font-size: 16px; /* Mant√©m 16px para evitar zoom */
      }
      
      .input-area button {
        width: 36px;
        height: 36px;
        min-width: 36px;
        font-size: 16px;
      }
      
      .chat-box {
        padding-bottom: 60px; /* Ajuste para telas menores */
      }
    }

    /* Smartphones (at√© 480px) */
    @media (min-width: 321px) and (max-width: 480px) {
      .header {
        padding: 8px;
      }
      
      .msg {
        max-width: 80%;
      }
      
      .input-area {
        padding: 8px;
      }
      
      .chat-box {
        padding-bottom: 65px;
      }
    }

    /* Tablets pequenos (at√© 768px) */
    @media (min-width: 481px) and (max-width: 768px) {
      .msg {
        max-width: 70%;
      }
      
      body {
        max-width: 600px;
        margin: 0 auto;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      
      .input-area {
        max-width: 600px;
        margin: 0 auto;
        left: 50%;
        transform: translateX(-50%);
      }
    }

    /* Tablets e desktops pequenos (at√© 992px) */
    @media (min-width: 769px) and (max-width: 992px) {
      body {
        max-width: 700px;
        margin: 0 auto;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      }
      
      .msg {
        max-width: 65%;
        font-size: 15px;
      }
      
      .input-area input {
        font-size: 16px; /* Mant√©m 16px para consist√™ncia */
      }
      
      .input-area {
        max-width: 700px;
        margin: 0 auto;
        left: 50%;
        transform: translateX(-50%);
      }
    }

    /* Desktops (acima de 992px) */
    @media (min-width: 993px) {
      body {
        max-width: 800px;
        margin: 0 auto;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
      }
      
      .header {
        padding: 12px 15px;
      }
      
      .avatar {
        width: 40px;
        height: 40px;
        min-width: 40px;
      }
      
      .user-info span.name {
        font-size: 18px;
      }
      
      .user-info span.status {
        font-size: 14px;
      }
      
      .msg {
        max-width: 60%;
        padding: 12px 18px;
        font-size: 15px;
        margin: 8px 0;
      }
      
      .input-area {
        padding: 12px 15px;
        max-width: 800px;
        margin: 0 auto;
        left: 50%;
        transform: translateX(-50%);
      }
      
      .input-area input {
        padding: 12px 15px;
        font-size: 16px; /* Mant√©m 16px para consist√™ncia */
      }
      
      .input-area button {
        width: 44px;
        height: 44px;
        min-width: 44px;
        font-size: 20px;
      }
      
      .chat-box {
        padding-bottom: 80px;
      }
    }

    /* Ajustes para orienta√ß√£o paisagem em dispositivos m√≥veis */
    @media (max-height: 500px) and (orientation: landscape) {
      .header {
        padding: 5px 10px;
      }
      
      .avatar {
        width: 30px;
        height: 30px;
        min-width: 30px;
      }
      
      .user-info span.name {
        font-size: 14px;
      }
      
      .user-info span.status {
        font-size: 11px;
      }
      
      .chat-box {
        padding: 5px;
        padding-bottom: 55px;
      }
      
      .msg {
        padding: 8px 12px;
        margin: 4px 0;
        font-size: 13px;
      }
      
      .input-area {
        padding: 5px 8px;
      }
      
      .input-area button {
        width: 34px;
        height: 34px;
        min-width: 34px;
      }
    }

    /* Ajustes para telas de alta resolu√ß√£o */
    @media (min-width: 1200px) {
      body {
        max-width: 900px;
      }
      
      .input-area {
        max-width: 900px;
      }
    }

    /* Ajustes para dispositivos com tela sens√≠vel ao toque */
    @media (hover: none) and (pointer: coarse) {
      .input-area button {
        padding: 0; /* Remove padding para evitar problemas em alguns dispositivos touch */
      }
      
      .header-right i {
        padding: 5px; /* Aumenta a √°rea de toque */
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
</head>
<body>
  <div class="header">
    <div class="header-left">
      <div class="avatar">
        <img src="images/logo.png" alt="Avatar">
      </div>
      <div class="user-info">
        <span class="name">Divino Tarot</span>
        <span class="status" id="statusText">Online</span>
      </div>
    </div>
    <div class="header-right">
      <i class="zmdi zmdi-videocam"></i>
      <i class="zmdi zmdi-phone"></i>
      <i class="zmdi zmdi-more-vert"></i>
    </div>
  </div>

  <div class="chat-box" id="chatBox"></div>

  <div class="input-area">
    <input type="text" id="userInput" placeholder="Digite aqui..." onkeydown="if(event.key === 'Enter'){enviarMensagem()}">
    <button onclick="enviarMensagem()">
      <i class="zmdi zmdi-mail-send"></i>
    </button>
  </div>

  <script>
    const chatBox = document.getElementById('chatBox');
    let step = 0; // Come√ßamos no passo 0 para controlar a sequ√™ncia inicial
    let typingIndicator;
    let finalStepReached = false;
    let autoResponseTimer = null; // Vari√°vel para controlar o timer de resposta autom√°tica
    let perguntaEnviada = false; // Vari√°vel para controlar se a pergunta j√° foi enviada
    let esperandoRespostaTiragem = false; // Vari√°vel para controlar o delay ap√≥s a tiragem
    let sequenciaInicialCompleta = false; // Vari√°vel para controlar se a sequ√™ncia inicial foi conclu√≠da
    let primeiraRespostaAposSequencia = true; // Vari√°vel para controlar a primeira resposta ap√≥s a sequ√™ncia inicial
    let mensagensFinaisEnviadas = false; // Vari√°vel para controlar se as mensagens finais foram enviadas
    let funilCompleto = false; // Vari√°vel para controlar se o funil foi completado
    let respostaTiragemRecebida = false; // Vari√°vel para controlar se a resposta da tiragem foi recebida
    let nomeUsuario = ""; // Vari√°vel para armazenar o nome do usu√°rio para personaliza√ß√£o

    function appendMessage(content, sender = 'bot', isHTML = false) {
      removeTyping();
      const msgDiv = document.createElement('div');
      msgDiv.classList.add('msg', sender);
      if (isHTML) {
        msgDiv.innerHTML = content;
      } else {
        msgDiv.textContent = content;
      }
      chatBox.appendChild(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function showTyping() {
      removeTyping();
      typingIndicator = document.createElement('div');
      typingIndicator.classList.add('msg', 'bot');
      typingIndicator.textContent = 'digitando...';
      typingIndicator.style.fontStyle = 'italic';
      chatBox.appendChild(typingIndicator);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    function removeTyping() {
      if (typingIndicator && typingIndicator.parentNode) {
        chatBox.removeChild(typingIndicator);
      }
    }

    // Lista de nomes comuns brasileiros para verifica√ß√£o
    const nomesComuns = [
      "maria", "ana", "jo√£o", "jose", "jos√©", "antonio", "ant√¥nio", "carlos", "paulo", "pedro", "lucas", 
      "luiz", "luis", "marcos", "gabriel", "rafael", "daniel", "marcelo", "bruno", "eduardo", "felipe", 
      "rodrigo", "manoel", "manuel", "andr√©", "andre", "adriano", "leonardo", "gustavo", "vitor", "victor", 
      "alexandre", "ricardo", "mariana", "juliana", "fernanda", "patricia", "patr√≠cia", "camila", "julia", 
      "j√∫lia", "amanda", "bruna", "leticia", "let√≠cia", "aline", "tatiana", "natalia", "nat√°lia", "carolina", 
      "beatriz", "larissa", "jessica", "j√©ssica", "gabriela", "vanessa", "luciana", "silvia", "s√≠lvia", 
      "renata", "isabela", "isabel", "vitoria", "vit√≥ria", "clara", "bianca", "carla", "sandra", "alice", 
      "luana", "raquel", "roberta", "michele", "monique", "simone", "sabrina", "eliane", "eliana", "rita", 
      "rosa", "vera", "teresa", "tereza", "cristina", "claudia", "cl√°udia", "angela", "√¢ngela", "marta", 
      "lucia", "l√∫cia", "adriana", "fabiana", "denise", "sueli", "suely", "valeria", "val√©ria", "rosana", 
      "ros√¢ngela", "rosangela", "aparecida", "concei√ß√£o", "concei√ßao", "fatima", "f√°tima", "benedita", 
      "antonia", "ant√¥nia", "francisca", "sebastiana", "sebasti√£o", "sebastiao", "jorge", "mateus", "matheus", 
      "thiago", "tiago", "henrique", "diego", "igor", "caio", "vinicius", "vin√≠cius", "samuel", "renan", 
      "arthur", "artur", "alex", "alan", "fabio", "f√°bio", "douglas", "leandro", "guilherme", "william", 
      "willian", "everton", "everton", "roberto", "rogerio", "rog√©rio", "sergio", "s√©rgio", "anderson", 
      "andersen", "mauricio", "maur√≠cio", "augusto", "renato", "cesar", "c√©sar", "edson", "erick", "eric", 
      "mario", "m√°rio", "flavio", "fl√°vio", "geraldo", "ronaldo", "nilton", "milton", "nelson", "wilson", 
      "wilton", "adilson", "ailton", "alisson", "allison", "dalton", "elton", "wellington", "welington", 
      "washington", "jefferson", "jeferson", "denilson", "edilson", "edmilson", "emerson", "√©merson", 
      "anderson", "andeson", "wanderson", "wandeson", "weslley", "wesley", "wendel", "wendell", "michel", 
      "miguel", "raphael", "davi", "david", "kevin", "kelvin", "bryan", "ryan", "luan", "kauan", "kau√£", 
      "kaua", "cau√£", "caua", "cau√™", "caue", "enzo", "valentina", "sophia", "sofia", "helena", "valentina", 
      "cecilia", "cec√≠lia", "lara", "giovanna", "giovana", "maria", "heloisa", "helo√≠sa", "helena", "luiza", 
      "louise", "livia", "l√≠via", "lorena", "yasmin", "jasmin", "lavinia", "lav√≠nia", "nicole", "emilly", 
      "emily", "sarah", "sara", "isis", "marina", "alicia", "al√≠cia", "luna", "rebeca", "agatha", "√°gatha", 
      "gabrielly", "milena", "catarina", "melissa", "emanuelly", "emanuelle", "emanuela", "ester", "esther", 
      "eduarda", "mariah", "stella", "stefany", "stefani", "stefanie", "estefani", "estef√¢nia", "estefania", 
      "anita", "aurora", "pietra", "mikaela", "micaela", "rafaela", "rayssa", "raissa", "ra√≠ssa", "raysa", 
      "raisa", "ra√≠sa", "mirella", "melina", "melinda", "melanie", "melany", "melaine", "melaine", "melaine"
    ];

    // Palavras que n√£o devem ser consideradas como nomes
    const palavrasNaoNomes = [
      "sim", "n√£o", "nao", "ok", "okay", "certo", "claro", "entendi", "entendido", "combinado", 
      "beleza", "blz", "oi", "ol√°", "ola", "bom", "dia", "tarde", "noite", "obrigado", "obrigada", 
      "obg", "vlw", "valeu", "legal", "top", "massa", "show", "joia", "j√≥ia", "bacana", "tranquilo", 
      "tranquila", "pois", "ent√£o", "entao", "agora", "depois", "antes", "hoje", "amanh√£", "amanha", 
      "ontem", "semana", "m√™s", "mes", "ano", "pr√≥ximo", "proximo", "passado", "seguinte", "anterior", 
      "quero", "desejo", "preciso", "necessito", "gostaria", "adoraria", "pretendo", "vou", "irei", 
      "farei", "posso", "consigo", "conseguirei", "talvez", "quem", "sabe", "como", "quando", "onde", 
      "porque", "porqu√™", "por", "que", "qual", "quais", "quanto", "quantos", "quantas", "quanta", 
      "muito", "muita", "muitos", "muitas", "pouco", "pouca", "poucos", "poucas", "bastante", "demais", 
      "tudo", "todo", "toda", "todos", "todas", "nada", "nenhum", "nenhuma", "nenhuns", "nenhumas", 
      "algum", "alguma", "alguns", "algumas", "outro", "outra", "outros", "outras", "mesmo", "mesma", 
      "mesmos", "mesmas", "pr√≥prio", "pr√≥pria", "pr√≥prios", "pr√≥prias", "proprio", "propria", "proprios", 
      "proprias", "cada", "qualquer", "quaisquer", "tanto", "tanta", "tantos", "tantas", "mais", "menos", 
      "maior", "menor", "maiores", "menores", "melhor", "pior", "melhores", "piores", "bom", "boa", 
      "bons", "boas", "mau", "m√°", "maus", "m√°s", "grande", "pequeno", "pequena", "grandes", "pequenos", 
      "pequenas", "alto", "alta", "altos", "altas", "baixo", "baixa", "baixos", "baixas", "novo", "nova", 
      "novos", "novas", "velho", "velha", "velhos", "velhas", "antigo", "antiga", "antigos", "antigas", 
      "caro", "cara", "caros", "caras", "barato", "barata", "baratos", "baratas", "f√°cil", "facil", 
      "dif√≠cil", "dificil", "f√°ceis", "faceis", "dif√≠ceis", "dificeis", "simples", "complexo", "complexa", 
      "complexos", "complexas", "r√°pido", "rapido", "r√°pida", "rapida", "r√°pidos", "rapidos", "r√°pidas", 
      "rapidas", "lento", "lenta", "lentos", "lentas", "devagar", "longe", "perto", "dentro", "fora", 
      "acima", "abaixo", "sobre", "sob", "entre", "atrav√©s", "atraves", "durante", "ap√≥s", "apos", 
      "antes", "depois", "desde", "at√©", "ate", "com", "sem", "para", "por", "em", "de", "do", "da", 
      "dos", "das", "no", "na", "nos", "nas", "ao", "aos", "√†", "√†s", "a", "as", "o", "os", "um", "uns", 
      "uma", "umas", "este", "esta", "estes", "estas", "esse", "essa", "esses", "essas", "aquele", 
      "aquela", "aqueles", "aquelas", "isto", "isso", "aquilo", "meu", "minha", "meus", "minhas", "teu", 
      "tua", "teus", "tuas", "seu", "sua", "seus", "suas", "nosso", "nossa", "nossos", "nossas", "vosso", 
      "vossa", "vossos", "vossas", "dele", "dela", "deles", "delas", "nele", "nela", "neles", "nelas", 
      "me", "te", "se", "nos", "vos", "lhe", "lhes", "o", "a", "os", "as", "lo", "la", "los", "las", 
      "eu", "tu", "ele", "ela", "n√≥s", "nos", "v√≥s", "vos", "eles", "elas", "voc√™", "voce", "voc√™s", 
      "voces", "senhor", "senhora", "senhores", "senhoras", "sr", "sra", "sr.", "sra.", "doutor", 
      "doutora", "dr", "dra", "dr.", "dra.", "professor", "professora", "prof", "profa", "prof.", "profa."
    ];

    // Fun√ß√£o melhorada para extrair nome do texto
    function extrairNome(texto) {
      // Remover caracteres especiais e converter para min√∫sculas
      const textoLimpo = texto.toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // Remove acentos
        .replace(/[^\w\s]/g, ' ') // Substitui caracteres especiais por espa√ßo
        .replace(/\s+/g, ' ').trim(); // Remove espa√ßos extras
      
      // Dividir o texto em palavras
      const palavras = textoLimpo.split(' ');
      
      // Verificar se o formato √© "nome, idade" ou "nome - idade"
      const formatoIdade = texto.match(/([A-Za-z√Ä-√ñ√ò-√∂√∏-√ø\s]+)[,\-]\s*(\d+)/i);
      if (formatoIdade && formatoIdade[1]) {
        return formatoIdade[1].trim().split(' ')[0]; // Retorna o primeiro nome
      }
      
      // Verificar se h√° algum nome comum na resposta
      for (const palavra of palavras) {
        // Verificar se a palavra tem pelo menos 3 caracteres e est√° na lista de nomes comuns
        if (palavra.length >= 3 && nomesComuns.includes(palavra) && !palavrasNaoNomes.includes(palavra)) {
          return palavra.charAt(0).toUpperCase() + palavra.slice(1); // Capitaliza o nome
        }
      }
      
      // Se n√£o encontrou um nome conhecido, verifica se a primeira palavra tem pelo menos 3 letras
      // e n√£o est√° na lista de palavras que n√£o s√£o nomes
      if (palavras[0] && palavras[0].length >= 3 && !palavrasNaoNomes.includes(palavras[0])) {
        return palavras[0].charAt(0).toUpperCase() + palavras[0].slice(1); // Capitaliza a primeira palavra
      }
      
      // Se nenhuma das verifica√ß√µes acima encontrou um nome, retorna string vazia
      return "";
    }

    function enviarMensagem() {
      const userInput = document.getElementById('userInput').value;
      if (!userInput.trim()) return;

      appendMessage(userInput, 'user');
      document.getElementById('userInput').value = '';
      
      // Se o funil j√° foi completado, apenas reenviar o link de pagamento
      if (funilCompleto) {
        setTimeout(() => reenviarLinkPagamento(), 1000);
        return;
      }
      
      // Se a sequ√™ncia inicial ainda n√£o foi conclu√≠da, ignorar completamente a resposta
      if (!sequenciaInicialCompleta) {
        return; // Ignorar completamente a resposta durante a sequ√™ncia inicial
      }
      
      // Cancelar o timer de resposta autom√°tica se o usu√°rio responder
      if (autoResponseTimer) {
        clearTimeout(autoResponseTimer);
        autoResponseTimer = null;
      }
      
      // Se for a primeira resposta ap√≥s a sequ√™ncia inicial, extrair o nome do usu√°rio
      if (primeiraRespostaAposSequencia) {
        nomeUsuario = extrairNome(userInput);
      }
      
      // Se estamos esperando resposta ap√≥s a tiragem, marcar que recebemos a resposta e iniciar o timer de 15 segundos
      if (esperandoRespostaTiragem) {
        respostaTiragemRecebida = true;
        setTimeout(() => {
          continuarAposTiragem();
        }, 15000); // 15 segundos de delay ap√≥s a resposta do usu√°rio
        esperandoRespostaTiragem = false;
        return;
      }
      
      // Se for a primeira resposta ap√≥s a sequ√™ncia inicial, tratar de forma especial
      if (primeiraRespostaAposSequencia) {
        primeiraRespostaAposSequencia = false;
        setTimeout(() => iniciarFluxoAposSequenciaInicial(userInput.toLowerCase()), 1000);
      } else {
        setTimeout(() => handleChatFlow(userInput.toLowerCase()), 1000);
      }
    }

    // Fun√ß√£o para reenviar o link de pagamento ap√≥s o funil estar completo
    function reenviarLinkPagamento() {
      showTyping();
      setTimeout(() => {
        appendMessage(`Aqui est√° o link para voc√™ garantir seu Ritual de Desbloqueio AGORA:<br>üëâ <a href='https://pagamento.divinotarot.site/checkout?product=e880f79b-2180-11f0-b1cb-46da4690ad53' target='_blank'>CLIQUE AQUI PARA GARANTIR SUA VAGA</a><br><br><span class="limited-offer">‚è∞ OFERTA V√ÅLIDA APENAS HOJE: √öltimas 3 vagas com desconto!</span>`, 'bot', true);
      }, 1500);
    }

    // Fun√ß√£o para iniciar o fluxo ap√≥s a sequ√™ncia inicial
    function iniciarFluxoAposSequenciaInicial(input) {
      const saudacao = nomeUsuario ? `${nomeUsuario}, ` : "";
      
      showTyping();
      setTimeout(() => {
        appendMessage(`${saudacao}senti uma energia intensa no momento em que voc√™ respondeu‚Ä¶ √© como se algo precisasse ser revelado urgente üåÄ`, 'bot');
        showTyping();
        setTimeout(() => {
          const msg6 = `<strong>Me diz com o cora√ß√£o aberto:</strong><br><br>Qual dessas situa√ß√µes mais descreve o que voc√™ sente hoje?<br><br>1Ô∏è‚É£ Quero meu amor de volta<br>2Ô∏è‚É£ Quero saber da minha vida amorosa<br>3Ô∏è‚É£ Quero saber se o amor √© correspondido`;
          appendMessage(msg6, 'bot', true);
          step = 6;
        }, 2000);
      }, 1500);
    }

    function handleChatFlow(input) {
      if (step === 6) {
        const opcoesValidas = ['1', '2', '3', 'um', 'dois', 'tr√™s', 'tres'];
        const encontrouOpcao = opcoesValidas.some(opcao => input.includes(opcao));
        if (encontrouOpcao) {
          step = 7;
          handleChatFlow();
        } else {
          appendMessage("Escolha 1, 2 ou 3, meu amor! üåü", 'bot');
        }
      } else if (step === 7) {
        showTyping();
        setTimeout(() => {
          appendMessage("<audio controls><source src='audio01.mp3' type='audio/mp3'>Seu navegador n√£o suporta o elemento de √°udio.</audio>", 'bot', true);
          showTyping();
          setTimeout(() => {
            appendMessage("J√° estou fazendo a tiragem das suas cartas!", 'bot');
            step = 10;
            setTimeout(() => {
              showTyping();
              setTimeout(() => {
                appendMessage("As cartas j√° me deram uma resposta‚Ä¶", 'bot');
                showTyping();
                setTimeout(() => {
                  appendMessage("üí´ Na tiragem das cartas, vejo algo muito claro sobre voc√™: Mesmo com a dist√¢ncia, voc√™ ainda carrega um la√ßo forte com essa pessoa ‚Äî e um desejo sincero de reviver esse amor.", 'bot');
                  showTyping();
                  setTimeout(() => {
                    const saudacao = nomeUsuario ? `${nomeUsuario}, ` : "";
                    appendMessage(`<img src='images/imagemoficial.png' alt='Imagem da tiragem' style='max-width: 100%; height: auto;'><br>${saudacao}agora que fizemos a tiragem, vou te contar o que cada uma destas cartas significam em sua vida, okay?`, 'bot', true);
                    step = 12;
                    esperandoRespostaTiragem = true; // Ativar o modo de espera ap√≥s a tiragem
                    respostaTiragemRecebida = false; // Resetar a vari√°vel de controle
                    
                    // N√£o configuramos timer autom√°tico aqui, pois o usu√°rio precisa responder para continuar
                  }, 1500);
                }, 1500);
              }, 1500);
            }, 30000);
          }, 1500);
        }, 2000);
      } else if (step === 17) {
        showTyping();
        setTimeout(() => {
          appendMessage(`üåü Esse ritual √© feito com prote√ß√£o espiritual e direcionamento personalizado para o seu caso. Ele tem o valor simb√≥lico de <strong>R$ 59,90</strong>, e pode ser feito hoje mesmo.`, 'bot', true);
          
          // Adicionar o depoimento da Jessica ap√≥s a mensagem sobre o valor do ritual
          showTyping();
          setTimeout(() => {
            appendMessage(`<img src='images/feedback.jpg' alt='Depoimento da Jessica' style='max-width: 100%; height: auto;'><br>Jessica recuperou seu amor em apenas 14 dias com o <strong>Ritual de Desbloqueio</strong>. Voc√™ pode ser a pr√≥xima! ‚ù§Ô∏è`, 'bot', true);
            
            showTyping();
            setTimeout(() => {
              const saudacao = nomeUsuario ? `${nomeUsuario}, ` : "";
              appendMessage(`<strong>${saudacao}me diz: SIM</strong> para seguir com o pagamento e iniciar o ritual!<br><br>Oferecemos garantia de satisfa√ß√£o: se n√£o perceber resultados em 30 dias, devolvemos seu investimento.`, 'bot', true);
              step = 18;
              perguntaEnviada = false; // Resetar a vari√°vel de controle
            }, 2000);
          }, 2000);
        }, 1500);
      } else if (step === 18 && !finalStepReached) {
        // Se a pergunta ainda n√£o foi enviada, enviar a pergunta
        if (!perguntaEnviada) {
          showTyping();
          setTimeout(() => {
            appendMessage("Quer que eu te envie o link para efetuar o pagamento e dar in√≠cio agora mesmo?", 'bot');
            perguntaEnviada = true; // Marcar que a pergunta j√° foi enviada
            
            // Configurar o timer para resposta autom√°tica ap√≥s 15 segundos
            autoResponseTimer = setTimeout(() => {
              if (!finalStepReached) {
                continuarFunil();
              }
            }, 15000);
          }, 1500);
        } 
        // Se a pergunta j√° foi enviada e o usu√°rio respondeu, continuar o funil
        else {
          continuarFunil();
        }
      } else {
        if (finalStepReached && !mensagensFinaisEnviadas) {
          enviarMensagensFinais();
        }
      }
    }

    // Fun√ß√£o para continuar o funil ap√≥s a pergunta de pagamento
    function continuarFunil() {
      showTyping();
      setTimeout(() => {
        appendMessage("Perfeito, meu amor!", 'bot');
        showTyping();
        setTimeout(() => {
          appendMessage(`Aqui est√° o link para voc√™ garantir seu Ritual de Desbloqueio AGORA:<br>üëâ <a href='https://pagamento.divinotarot.site/checkout?product=e880f79b-2180-11f0-b1cb-46da4690ad53' target='_blank'>CLIQUE AQUI PARA GARANTIR SUA VAGA</a><br><br><span class="limited-offer">‚è∞ OFERTA V√ÅLIDA APENAS HOJE: √öltimas 3 vagas com desconto!</span>`, 'bot', true);
          finalStepReached = true;
          
          // Enviar as mensagens finais ap√≥s 2 segundos
          setTimeout(() => {
            enviarMensagensFinais();
          }, 2000);
        }, 1500);
      }, 1500);
    }

    // Fun√ß√£o para enviar as mensagens finais
    function enviarMensagensFinais() {
      if (mensagensFinaisEnviadas) return; // Evitar envio duplicado
      
      const saudacao = nomeUsuario ? `${nomeUsuario}, ` : "";
      
      showTyping();
      setTimeout(() => {
        appendMessage(`${saudacao}n√£o perca essa oportunidade! Mais de 1.500 pessoas j√° realizaram esse ritual com resultados incr√≠veis em seus relacionamentos.`, 'bot');
        showTyping();
        setTimeout(() => {
          appendMessage(`Aproveite os hor√°rios dispon√≠veis ainda hoje! Restam apenas 3 vagas para hoje! üö®<br><br>Clique no link acima <strong>AGORA</strong> para garantir seu lugar antes que outra pessoa reserve.`, 'bot', true);
          mensagensFinaisEnviadas = true;
          funilCompleto = true; // Marcar que o funil foi completado
        }, 1500);
      }, 1500);
    }

    // Fun√ß√£o para continuar ap√≥s a tiragem com delay de 15 segundos
    function continuarAposTiragem() {
      // S√≥ continua se o usu√°rio tiver respondido
      if (!respostaTiragemRecebida) return;
      
      showTyping();
      setTimeout(() => {
        appendMessage(`üîÆ 01. O Diabo (invertido)<br>Rela√ß√£o marcada por depend√™ncia, possessividade ou obsess√£o. Invertida, mostra chance de liberta√ß√£o desses padr√µes e reconquista mais saud√°vel.`, 'bot', true);
        showTyping();
        setTimeout(() => {
          appendMessage(`üîÆ 02. Dez de Espadas<br>Fim doloroso, t√©rmino dif√≠cil. Mas tamb√©m sinal de que o pior j√° passou e um novo ciclo pode come√ßar.`, 'bot', true);
          showTyping();
          setTimeout(() => {
            appendMessage(`üîÆ 03. A Temperan√ßa<br>Reconcilia√ß√£o, equil√≠brio, cura emocional. Indica possibilidade de volta com mais harmonia e sabedoria.`, 'bot', true);
            showTyping();
            setTimeout(() => {
              const nomeResumo = nomeUsuario ? ` ${nomeUsuario.toUpperCase()}` : "";
              appendMessage(`<span style='font-weight: bold; font-size: 15px;'>RESUMO FINAL DA SUA CONSULTA${nomeResumo}:</span>`, 'bot', true);
              showTyping();
              setTimeout(() => {
                appendMessage("<audio controls><source src='audio02.mp3' type='audio/mp3'>Seu navegador n√£o suporta o elemento de √°udio.</audio>", 'bot', true);
                
                // Adicionar delay de 10 segundos ap√≥s o √°udio antes de mostrar a pr√≥xima mensagem
                setTimeout(() => {
                  showTyping();
                  setTimeout(() => {
                    appendMessage(`Mas isso tem solu√ß√£o ‚Äî e eu posso te ajudar com um <strong>Ritual de Desbloqueio e Alinhamento Amoroso</strong> que vai limpar esse caminho e reabrir as portas pro retorno acontecer.`, 'bot', true);
                    showTyping();
                    setTimeout(() => {
                      appendMessage(`<span style='font-weight: bold; color: #d32f2f; font-size: 15px;'> VOC√ä DESEJA FAZER? MUITO IMPORTANTE üôå</span><br><br>95% das pessoas que realizaram esse ritual relataram melhoras significativas em seus relacionamentos!`, 'bot', true);
                      step = 17;
                    }, 1500);
                  }, 1500);
                }, 10000); // 10 segundos de delay ap√≥s o √°udio
                
              }, 1500);
            }, 1500);
          }, 1500);
        }, 1500);
      }, 1500);
    }

    // Fun√ß√£o para mostrar as mensagens iniciais em sequ√™ncia sem interrup√ß√£o
    function mostrarSequenciaInicial() {
      const mensagensIniciais = [
        "<strong>Oi, meu amor! ‚ú® Seja muito bem-vinda ao Divino Tarot.</strong>",
        "Sou M√£e Erenice e senti sua energia antes mesmo de voc√™ chegar... Por isso, preparei uma tiragem <strong>GRATUITA</strong> e exclusiva. Mas preciso come√ßar agora, essa conex√£o √© forte e recente! üîÆ",
        "Pra eu me conectar melhor com sua energia e iniciar a tiragem, preciso de algumas informa√ß√µes rapidinhas‚Ä¶",
        "üíå Me diga: qual seu nome completo e sua idade?<br><br><strong>(Ex: Maria de Souza, 28 anos)</strong>"
      ];

      let index = 0;
      
      function mostrarProximaMensagem() {
        if (index < mensagensIniciais.length) {
          showTyping();
          setTimeout(() => {
            appendMessage(mensagensIniciais[index], 'bot', true);
            index++;
            if (index < mensagensIniciais.length) {
              setTimeout(mostrarProximaMensagem, 2500);
            } else {
              // Todas as mensagens iniciais foram mostradas
              sequenciaInicialCompleta = true;
              step = 4; // Avan√ßar para o pr√≥ximo passo ap√≥s a sequ√™ncia inicial
            }
          }, 1000);
        }
      }
      
      mostrarProximaMensagem();
    }

    window.onload = () => {
      // Iniciar a sequ√™ncia de mensagens iniciais n√£o interrupt√≠vel
      mostrarSequenciaInicial();
    };
  </script>
</body>
</html>
